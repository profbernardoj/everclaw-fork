# 2026-02-11

## Provider Cooldown Cascade Fix (20:51 CST)

David reported being offline for hours due to Venice + Morpheus both entering cooldown. Diagnosed and fixed the root cause.

### Root Cause
- Venice ran out of API credits → billing error → cooldown
- Morpheus proxy returned generic 502 errors that OpenClaw misclassified as billing errors → cooldown
- Once both providers in cooldown, OpenClaw couldn't reach any model for 6+ hours
- The cooldown cascade repeated throughout Feb 9-11 (logs showed failures at 20:11 Feb 9 through 02:48 Feb 11)

### Fixes Implemented
1. **Deepened fallback chain:** `venice/claude-opus-4-6` → `venice/claude-opus-45` → `venice/kimi-k2-5` → `morpheus/kimi-k2.5` (was only claude-opus-4-6 → morpheus/kimi-k2.5)
2. **Fixed Morpheus proxy error format:** Now returns proper OpenAI-compatible errors with `type: "server_error"` (not billing) and specific codes like `morpheus_session_error`, `morpheus_inference_error`, `timeout`
3. **Added retry-with-new-session logic:** Proxy invalidates expired sessions and retries once with a fresh session before failing
4. **Added `venice/kimi-k2-5`** to Venice provider models config (was missing)

### Key Detail - David's Preferences
- Do NOT use llama-3.3-70b or deepseek-v3.2 as backup models
- Use Claude 4.5 and Kimi K2.5 as backups on Venice, Kimi K2.5 on Morpheus

### Files Changed
- `~/morpheus/proxy/morpheus-proxy.mjs` — new error handling, retry logic, OpenAI-compatible error format
- `~/.openclaw/openclaw.json` — fallback chain, venice/kimi-k2-5 model added

### Also Noticed
- OpenClaw slug-generator tries to use `anthropic/claude-opus-4-6` directly (not via Venice) and fails with "No API key for provider anthropic" — this is a separate issue, not blocking but worth noting
- Signal-cli showing frequent "Connection closed unexpectedly" and thread starvation warnings — may need investigation later

## Everclaw v0.5.0 Published (21:10 CST)

David asked to roll all the cooldown cascade fixes into the Everclaw skill and bump to v0.5.

### Changes to Everclaw
1. **SKILL.md** (v0.4.0 → v0.5.0):
   - New "Proxy Resilience (v0.5)" section documenting the cooldown cascade problem and all three fixes
   - Error code table: `morpheus_session_error`, `morpheus_inference_error`, `morpheus_upstream_error`, `timeout`, `model_not_found`
   - Updated OpenClaw integration section with recommended 4-tier fallback config
   - Updated failover behavior documentation with v0.5 improvements
   - Quick reference bumped to v0.5
   - Description updated to mention auto-retry, error classification

2. **scripts/morpheus-proxy.mjs** — copied updated proxy from `~/morpheus/proxy/morpheus-proxy.mjs` with all error handling and retry logic

3. **README.md** — added Session Auto-Retry and Cooldown-Safe Errors to the core features table

4. **Website (docs/index.html + website/index.html)**:
   - v0.5.0 version badge in header
   - "What's New in v0.5" 3-column section (cooldown-safe errors, session auto-retry, multi-tier fallback)
   - Updated proxy feature card
   - New footer links: Full Docs (SKILL.md on GitHub), v0.5.0 Release tag
   - Responsive mobile grid

### GitHub
- Repo: `profbernardoj/everclaw`
- Tagged: `v0.5.0`
- Website: everclaw.xyz (GitHub Pages from docs/ folder)
- Had to rebase over remote CNAME commits before pushing

## Everclaw Model Router Built (21:38 CST)

David wanted to reduce costs by routing different tasks to different models. Evaluated ClawRouter (BlockRunAI/ClawRouter) but decided to build our own because:
- ClawRouter routes through BlockRun's API (adds a middleman) — we have free/cheap inference via Venice + Morpheus
- Stores wallet key as plaintext file (our security uses Keychain)
- Install script does curl|bash and overwrites OpenClaw config
- Their model list doesn't include our Venice/Morpheus models

### What We Built
- `scripts/router.mjs` — 13-dimension weighted prompt classifier, <1ms, zero external calls
- 3 tiers: LIGHT (glm-4.7-flash), STANDARD (kimi-k2.5), HEAVY (claude-opus-4-6)
- Adapted from ClawRouter's scoring logic (MIT license, no issue using it)
- Key dimensions: reasoning markers (0.20), code presence (0.14), synthesis (0.11), technical terms (0.10), multi-step (0.10)
- Reasoning override: 2+ reasoning keywords → force HEAVY at 88%+ confidence
- Ambiguous prompts default to STANDARD (safe middle ground)

### Cron Jobs Updated
All 10 isolated agentTurn cron jobs now use `"model": "morpheus/kimi-k2.5"` instead of defaulting to Claude 4.6:
- Morning Briefings (weekday + weekend)
- Daily Capabilities Report
- Mon-Fri Goal Advisors (Space, Wealth, Commission, Abolition, Synthesis)
- Saturday Weekend Fun Planner
- Sunday Week Ahead Preview

### x402 Assessment (for future work)
- x402 (x402.org) is an HTTP-native payment protocol: server returns 402, client signs USDC, retries
- Perfect for agent-to-agent payments via 8004 Agent Registry on Base
- Both x402 and 8004 are already live on Base — next workstream after router
- ClawRouter's x402 client code (wallet signing, 402 handling, retry) is reusable
- We'd use our Bagman/Keychain wallet instead of their plaintext approach

### David's Preferences (model routing)
- Do NOT use llama-3.3-70b or deepseek-v3.2 as backup models
- Claude 4.6 for complex reasoning only (expensive)
- Kimi K2.5 for most cron/sub-agent work (free via Morpheus staking)
- GLM 4.7 Flash for trivial tasks (free, fast)

## Everclaw v0.6.0 Published (21:52 CST)

David wanted GLM-4.7-Flash via Morpheus as an option for Light tier jobs, then bump to v0.6.

### Changes
- Verified GLM Flash works via Morpheus proxy (tested inference)
- SKILL.md: added Section 16 — Model Router (v0.6) with full documentation
  - 13-dimension scoring table, CLI usage, programmatic API
  - Cron job and sub-agent spawn integration examples
  - Cost impact comparison (before/after)
- README: added Model Router to features + quick reference
- Website: v0.6 badge, 4-column What's New (Router, GLM Flash, Cooldown-Safe, Auto-Retry), new Router feature card
- Tagged v0.6.0, pushed to GitHub
- GLM Flash confirmed operational via `curl http://127.0.0.1:8083/v1/chat/completions` with model `glm-4.7-flash`

## x402 Payment Client & ERC-8004 Agent Registry (22:08 CST)

Built both modules and tested against live Base mainnet.

### x402-client.mjs
- Automatic HTTP 402 payment flow: detect → parse PAYMENT-REQUIRED → sign EIP-712 → retry with PAYMENT-SIGNATURE
- Uses EIP-3009 TransferWithAuthorization (USDC on Base supports this natively)
- Private key from 1Password at runtime via Bagman pattern
- Budget controls: $1/request max, $10/day default
- Dry-run mode for testing
- `createX402Client()` factory for reusable configured clients

### agent-registry.mjs
- Reads ERC-8004 Identity Registry (ERC-721 + URIStorage) on Base
- Reads ERC-8004 Reputation Registry (feedback, scores, clients)
- Handles data: URIs (base64 on-chain JSON), ipfs://, and https://
- `lookupAgent(id)` — identity + registration file
- `getReputation(id)` — feedback summary + all reviews
- `discoverAgent(id)` — full pipeline: identity → fetch registration → check reputation
- `totalAgents()` — binary search fallback since totalSupply() not available

### Live Test Results
- Agent #1 on Base = ClawNews ("Hacker News for AI agents")
- Agent #5 on Base = Olas liquidity trader
- Reputation Registry works: Agent #1 has 2 reviews, score 100
- Registration files correctly decoded from base64 data URIs

### Key Addresses (Base Mainnet)
- Identity Registry: `0x8004A169FB4a3325136EB29fA0ceB6D2e539a432`
- Reputation Registry: `0x8004BAa17C55a88189AE136b182e5fdA19dE9b63`
- USDC: `0x833589fCD6eDb6E08f4c7C32D4f71b54bdA02913`
- Facilitator: `https://api.cdp.coinbase.com/platform/v2/x402`

### Sub-agent Note
- Spawned Kimi K2.5 sub-agent for this task but it completed in 2 seconds with no output
- Kimi K2.5 may not handle complex multi-file build tasks well — stick to Claude for heavy coding work
- This validates the router's tier system: complex coding = HEAVY tier

## Mission Control Dashboard Rebuilt (22:52 CST)
- Rebuilt dashboard to load from `dashboard-data.json` instead of hardcoded data
- Added `generate-data.mjs` script that reads memory files, goals, USER.md, MEMORY.md
- New **Life Goals tab** showing all 6 life goals with expandable sub-goals
- Fixed `file://` protocol issue: data now embedded inline into HTML
- Cron job: "Dashboard Refresh" daily at 3:00 AM CST (GLM Flash, isolated)
- Cron job ID: `64578090-7c65-442f-a75f-52eec68341a6`

## SmartAgentProtocol GitHub Org (23:30 CST)
- Accepted invitation to SmartAgentProtocol org as admin/owner
- Org: https://github.com/orgs/SmartAgentProtocol
- Description: "Open Source Chat Interface For Wallets, Dapps, DAOs, & Smart Contracts"
- Handle: profbernardoj

## Balaji Insight Saved (09:16 CST)
Saved @balajis X post about 10 durable skills in the age of AI (vision, verification, prompting, polishing, community, geography, scarcity, cryptography, physicality, resiliency). Cross-referenced to abolition-of-state goal (Network State as voluntary governance) and family goal (education framework for children). File: `memory/insights/balaji-value-in-age-of-ai.md`

## Everclaw v0.8 — Morpheus API Gateway Bootstrap (11:32 CST)
David wants to reduce friction for new OpenClaw users by providing free inference at startup.

### Concept
- New users don't have a Claude API key — Everclaw v0.8 provides a free Morpheus API Gateway key to bootstrap
- Morpheus API Gateway (api.mor.org) is in free beta until March 1, 2026
- Community key included in install (base64-obfuscated)
- First action after bootstrap: user gets their own free key at app.mor.org

### Keys Provided
- BernardoJohnstonTestKey: `sk-ZJXioE.1d5c6...` (for testing)
- SmartAgentProtocol Key: `sk-idtMPI.bee04...` (to include as bootstrap key)

### API Gateway Details
- Base URL: `https://api.mor.org/api/v1` (NOT /v1 — needs /api/v1)
- OpenAI-compatible (same format as our Morpheus proxy)
- 34 models available (kimi-k2.5, glm-4.7-flash, llama-3.3-70b, qwen3-235b, etc.)
- **Critical:** Each account needs "session automation" enabled in settings, or API calls return 403-like error

### Issue Discovered
- Both keys returning "Session automation is disabled" — need David to enable automation on both accounts at app.mor.org
- Earlier test of BernardoJohnston key worked (got successful kimi-k2.5 response), then stopped — possibly per-session or time-based automation toggle

### Script Built
- `scripts/bootstrap-gateway.mjs` — configures `mor-gateway` provider in OpenClaw
- Tests connection, patches openclaw.json, adds to fallback chain
- Supports `--key YOUR_KEY`, `--test`, `--status` commands
- Community key stored as base64 (not security — just anti-scraping for free beta key)

### Reminder Set
- Cron: Feb 22 warning about March 1 beta expiry (ID: 9b7d448c)

## Tomorrow's Plan: SmartAgentProtocol (23:33 CST)
David wants to develop a full version of OpenClaw under SmartAgentProtocol that:
- Wraps all Everclaw improvements into an easy-install package
- Targets users NOT comfortable with Terminal
- Uses proper GitHub best practices: pull requests, higher testing bar
- NOT the same workflow as Everclaw (direct push to main) — needs PRs, reviews, CI
- Goal: make decentralized AI inference accessible to non-technical users
